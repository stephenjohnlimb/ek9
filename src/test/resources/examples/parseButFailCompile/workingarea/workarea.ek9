#!ek9
<?-

  Workspace. Work in progress for the PRE_IR_CHECKS errors.
  Also check unset properties in a generic context.
-?>
defines module just.workspace

  defines function

    ConditionalAssignment10()
      missingMiddle <- true
      varAsTrue <- true
      anInt as Integer?

      if missingMiddle
        //In this case this scope does not access or set anInt
        //But both paths inside this scope do
        anyVar <- 55
        assert anyVar?

        if varAsTrue
          anInt: 33
          assert anInt?
        else
          anInt: 34
          assert anInt?

      @Error: PRE_IR_CHECKS: USED_BEFORE_INITIALISED
      assert anInt?

  <!-
  defines class

    //Note that we could error is the type is non-abstract and could have been initialised.
    //i.e. with prop1 <- String() - so if the type has a default constructor for example.
    C0
      prop1 as String?
      prop2 as String?

      method1()
        -> arg0 as String
        //Expect an error here because prop1 has never been initialised anywhere
        prop1 :=: arg0

      method2()
        -> arg0 as String
        prop2: arg0

      method3()
        -> arg0 as String
        //Now this 'may be ok' but will depend if method2 was called before.
        //So we cannot easily detect this
        prop2 :=: arg0
  -!>

//EOF

