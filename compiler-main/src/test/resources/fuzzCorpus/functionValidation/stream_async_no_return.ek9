#!ek9
<?-
  FUNCTION_MUST_RETURN_VALUE: Stream async with function that has no return.
  Functions used in stream async operations must return values.
-?>
defines module fuzztest.function.stream.async.noreturn

  defines class
    StringCollector
      joined <- String()

      operator |
        -> arg0 as String
        if arg0?
          if joined?
            joined += " " + arg0
          else
            joined: String(arg0)

      override operator ? as pure
        <- rtn as Boolean: joined?

  defines function
    noReturnValue()
      value <- 99
      assert value?
      // No return statement - function returns Void

    testStreamAsync()
      collector <- StringCollector()

      // Error: async requires function to return a value
      @Error: FULL_RESOLUTION: FUNCTION_MUST_RETURN_VALUE
      cat [noReturnValue] | async > collector

      assert collector?

//EOF
