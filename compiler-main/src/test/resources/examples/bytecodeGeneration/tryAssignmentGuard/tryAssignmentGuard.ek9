#!ek9
defines module bytecode.test.tryassignguard

  defines program

    @BYTECODE: CODE_GENERATION_AGGREGATES: TYPE: "bytecode.test.tryassignguard::TryAssignmentGuard": `public class bytecode.test.tryassignguard.TryAssignmentGuard {
  public bytecode.test.tryassignguard.TryAssignmentGuard();
    Code:
         0: aload_0
         1: invokespecial #CP                  // Method java/lang/Object."<init>":()V
         4: aload_0
         5: invokevirtual #CP                 // Method i_init:()V
         8: return

  public void _main(org.ek9.lang.Integer);
    Code:
         0: aconst_null
         1: astore_2
         2: new           #CP                 // class org/ek9/lang/Stdout
         5: dup
         6: invokespecial #CP                 // Method org/ek9/lang/Stdout."<init>":()V
         9: astore_3
        10: aload_3
        11: astore_2
        12: aconst_null
        13: astore        4
        15: new           #CP                 // class org/ek9/lang/String
        18: dup
        19: invokespecial #CP                 // Method org/ek9/lang/String."<init>":()V
        22: astore        5
        24: aload         5
        26: astore        4
        28: aload_1
        29: astore        6
        31: iconst_0
        32: invokestatic  #CP                 // Method java/lang/Integer.toString:(I)Ljava/lang/String;
        35: invokestatic  #CP                 // Method org/ek9/lang/Integer._of:(Ljava/lang/String;)Lorg/ek9/lang/Integer;
        38: astore        7
        40: aload         6
        42: aload         7
        44: invokevirtual #CP                 // Method org/ek9/lang/Integer._gt:(Lorg/ek9/lang/Integer;)Lorg/ek9/lang/Boolean;
        47: astore        8
        49: aload         8
        51: invokevirtual #CP                 // Method org/ek9/lang/Boolean._true:()Z
        54: istore        9
        56: iload         9
        58: ifeq          75
        61: ldc           #CP                 // String config-value
        63: invokestatic  #CP                 // Method org/ek9/lang/String._of:(Ljava/lang/String;)Lorg/ek9/lang/String;
        66: astore        10
        68: aload         10
        70: astore        4
        72: goto          75
        75: aload         4
        77: astore        11
        79: aload         11
        81: ifnull        88
        84: iconst_0
        85: goto          89
        88: iconst_1
        89: istore        12
        91: iload         12
        93: ifeq          108
        96: invokestatic  #CP                 // Method org/ek9/lang/Boolean._ofFalse:()Lorg/ek9/lang/Boolean;
        99: astore        13
       101: aload         13
       103: astore        14
       105: goto          119
       108: aload         11
       110: invokevirtual #CP                 // Method org/ek9/lang/String._isSet:()Lorg/ek9/lang/Boolean;
       113: astore        15
       115: aload         15
       117: astore        14
       119: aload         14
       121: invokevirtual #CP                 // Method org/ek9/lang/Boolean._true:()Z
       124: istore        16
       126: iload         16
       128: ifeq          293
       131: aconst_null
       132: astore        17
       134: aload         4
       136: astore        18
       138: aload         18
       140: astore        17
       142: aload         17
       144: ifnull        151
       147: iconst_0
       148: goto          152
       151: iconst_1
       152: istore        19
       154: iload         19
       156: ifeq          171
       159: invokestatic  #CP                 // Method org/ek9/lang/Boolean._ofFalse:()Lorg/ek9/lang/Boolean;
       162: astore        20
       164: aload         20
       166: astore        21
       168: goto          186
       171: aload         17
       173: astore        22
       175: aload         22
       177: invokevirtual #CP                 // Method org/ek9/lang/String._isSet:()Lorg/ek9/lang/Boolean;
       180: astore        23
       182: aload         23
       184: astore        21
       186: aload         21
       188: invokevirtual #CP                 // Method org/ek9/lang/Boolean._true:()Z
       191: istore        24
       193: iload         24
       195: ifeq          290
       198: aconst_null
       199: astore        25
       201: aload_2
       202: astore        26
       204: ldc           #CP                 // String Config:
       206: invokestatic  #CP                 // Method org/ek9/lang/String._of:(Ljava/lang/String;)Lorg/ek9/lang/String;
       209: astore        27
       211: aload         17
       213: astore        28
       215: aload         27
       217: aload         28
       219: invokevirtual #CP                 // Method org/ek9/lang/String._add:(Lorg/ek9/lang/String;)Lorg/ek9/lang/String;
       222: astore        29
       224: aload         26
       226: aload         29
       228: invokevirtual #CP                 // Method org/ek9/lang/Stdout.println:(Lorg/ek9/lang/String;)V
       231: goto          262
       234: astore        30
       236: aload_2
       237: astore        31
       239: ldc           #CP                 // String Error
       241: invokestatic  #CP                 // Method org/ek9/lang/String._of:(Ljava/lang/String;)Lorg/ek9/lang/String;
       244: astore        32
       246: aload         31
       248: aload         32
       250: invokevirtual #CP                 // Method org/ek9/lang/Stdout.println:(Lorg/ek9/lang/String;)V
       253: goto          262
       256: athrow
       257: astore        25
       259: goto          262
       262: aload_2
       263: astore        33
       265: ldc           #CP                 // String Cleanup
       267: invokestatic  #CP                 // Method org/ek9/lang/String._of:(Ljava/lang/String;)Lorg/ek9/lang/String;
       270: astore        34
       272: aload         33
       274: aload         34
       276: invokevirtual #CP                 // Method org/ek9/lang/Stdout.println:(Lorg/ek9/lang/String;)V
       279: aload         25
       281: ifnull        287
       284: aload         25
       286: athrow
       287: goto          290
       290: goto          293
       293: aload_2
       294: astore        35
       296: ldc           #CP                 // String Done
       298: invokestatic  #CP                 // Method org/ek9/lang/String._of:(Ljava/lang/String;)Lorg/ek9/lang/String;
       301: astore        36
       303: aload         35
       305: aload         36
       307: invokevirtual #CP                 // Method org/ek9/lang/Stdout.println:(Lorg/ek9/lang/String;)V
       310: return
      Exception table:
         from    to  target type
           201   231   234   Class org/ek9/lang/Exception
           262   287   256   Class org/ek9/lang/Exception
           201   256   257   any

  static {};
    Code:
         0: return

  private void i_init();
    Code:
         0: return
}`

    TryAssignmentGuard()
      -> input as Integer
      stdout <- Stdout()

      // Simulating assignment guard (:=) for try
      exprValue <- String()
      if input > 0
        exprValue: "config-value"

      // Only run try if value is set
      if exprValue?
        try config <- exprValue
          stdout.println("Config: " + config)
        catch
          -> ex as Exception
          stdout.println("Error")
        finally
          stdout.println("Cleanup")

      stdout.println("Done")
//EOF
