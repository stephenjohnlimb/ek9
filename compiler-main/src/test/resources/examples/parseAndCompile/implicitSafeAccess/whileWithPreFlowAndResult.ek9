#!ek9
<?-
  Result safe access with while pre-flow.
-?>
defines module preflow.withwhile.result

  defines function

    <?-
      Just a test fixture.
    -?>
    getExplicitResult()
      <- rtn <- Result("Steve", Integer())

    whileWithoutPreFlow()
      o <- getExplicitResult()

      triggerToEndLoop <- false
      if o?
        while not triggerToEndLoop
          val <- o.ok()
          assert val?
          triggerToEndLoop: true

    whileWithPreFlow()
      triggerToEndLoop <- false

      while o <- getExplicitResult() then not triggerToEndLoop
        val <- o.ok()
        assert val?
        triggerToEndLoop: true

    doWithoutPreFlow()
      o <- getExplicitResult()

      triggerToEndLoop <- false
      if o?
        do
          val <- o.ok()
          assert val?
          triggerToEndLoop: true
        while not triggerToEndLoop

    doWithPreFlow()
      triggerToEndLoop <- false

      do o <- getExplicitResult()
        val <- o.ok()
        assert val?
        triggerToEndLoop: true
      while not triggerToEndLoop

//EOF