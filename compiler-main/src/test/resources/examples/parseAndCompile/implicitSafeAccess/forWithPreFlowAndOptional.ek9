#!ek9
<?-
  Examples of for loops and for 'range' with pre-flow.
-?>
defines module preflow.withfor.optional

  defines function

    <?-
      Just a test fixture.
    -?>
    getExplicitOptional()
      <- rtn <- Optional("Steve")

    <?-
      Another test fixture
    -?>
    getList()
      <- rtn <- [1, 2, 3, 4]

    forLoopWithoutPreFlow()
      o <- getExplicitOptional()
      if o?
        for item in getList()
          val <- o.get()
          assert val?

    <?-
      Use the declaration form in the pre-flow.
    -?>
    forLoopWithPreFlow1()

      for o <- getExplicitOptional() then item in getList()
        val <- o.get()
        assert val?

    <?-
      Use guarded assignment form in the pre-flow
    -?>
    forLoopWithPreFlow2()

      o <- Optional(String())
      for o ?= getExplicitOptional() then item in getList()
        val <- o.get()
        assert val?


    forRangeWithPreFlow1()

      for o <- getExplicitOptional() then item in 1 ... 10
        val <- o.get()
        assert val?

//EOF