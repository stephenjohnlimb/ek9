#!ek9
<?-
  Test synthetic generation of _cmp (<=>) and _eq (==) operators for a class.

  This test verifies:
  1. The SyntheticOperatorGenerator is invoked for default operators
  2. The generated IR is correctly structured for both operators

  The _cmp operator should compare fields and return Integer:
  - If this or other is unset, return unset
  - If any field comparison returns non-zero, return that value
  - If all field comparisons return zero, return zero

  The _eq operator should compare fields and return Boolean:
  - If this or other is unset, return unset
  - If all field comparisons are equal, return true
  - Otherwise return false

  Note: default operator == requires default operator <=> to exist.
-?>
defines module synthetic.classEquals

  defines class

    @IR: IR_GENERATION: TYPE: "synthetic.classEquals::Person": `ConstructDfn: synthetic.classEquals::Person
Field: name, org.ek9.lang::String  
Field: age, org.ek9.lang::Integer  
OperationDfn: synthetic.classEquals::Person._fieldSetStatus()->org.ek9.lang::Bits  
BasicBlock: _entry_4
SCOPE_ENTER __fieldSetStatus_1
REFERENCE rtn, org.ek9.lang::Bits
_temp54 = LOAD_LITERAL org.ek9.lang::String
RETAIN _temp54
SCOPE_REGISTER _temp54, __fieldSetStatus_1
_temp55 = CALL (org.ek9.lang::Bits)org.ek9.lang::Bits.<init>(_temp54) [pure=false, complexity=0]
RETAIN _temp55
SCOPE_REGISTER _temp55, __fieldSetStatus_1
STORE rtn, _temp55
RETAIN rtn
_temp56 = LOAD this.name
RETAIN _temp56
SCOPE_REGISTER _temp56, __fieldSetStatus_1
_temp57 = CALL (org.ek9.lang::String)_temp56._isSet() [pure=false, complexity=0]
RETAIN _temp57
SCOPE_REGISTER _temp57, __fieldSetStatus_1
CALL (org.ek9.lang::Bits)rtn._addAss(_temp57) [pure=false, complexity=0]
_temp58 = LOAD this.age
RETAIN _temp58
SCOPE_REGISTER _temp58, __fieldSetStatus_1
_temp59 = CALL (org.ek9.lang::Integer)_temp58._isSet() [pure=false, complexity=0]
RETAIN _temp59
SCOPE_REGISTER _temp59, __fieldSetStatus_1
CALL (org.ek9.lang::Bits)rtn._addAss(_temp59) [pure=false, complexity=0]
SCOPE_EXIT __fieldSetStatus_1
RETURN rtn
OperationDfn: synthetic.classEquals::Person._eq(synthetic.classEquals::Person)->org.ek9.lang::Boolean  
BasicBlock: _entry_2
SCOPE_ENTER __eq_1
REFERENCE rtn, org.ek9.lang::Boolean
_temp29 = CALL (synthetic.classEquals::Person)this._isSet() [pure=false, complexity=0]
RETAIN _temp29
SCOPE_REGISTER _temp29, __eq_1
_temp30 = CALL (org.ek9.lang::Boolean)_temp29._true() [pure=false, complexity=0]
BRANCH_FALSE _temp30, _return_unset_2
_temp31 = CALL (synthetic.classEquals::Person)param._isSet() [pure=false, complexity=0]
RETAIN _temp31
SCOPE_REGISTER _temp31, __eq_1
_temp32 = CALL (org.ek9.lang::Boolean)_temp31._true() [pure=false, complexity=0]
BRANCH_FALSE _temp32, _return_unset_2
_temp33 = CALL (synthetic.classEquals::Person)this._fieldSetStatus() [pure=false, complexity=0]
RETAIN _temp33
SCOPE_REGISTER _temp33, __eq_1
_temp34 = CALL (synthetic.classEquals::Person)param._fieldSetStatus() [pure=false, complexity=0]
RETAIN _temp34
SCOPE_REGISTER _temp34, __eq_1
_temp35 = CALL (org.ek9.lang::Bits)_temp33._eq(_temp34) [pure=false, complexity=0]
RETAIN _temp35
SCOPE_REGISTER _temp35, __eq_1
_temp36 = CALL (org.ek9.lang::Boolean)_temp35._isSet() [pure=false, complexity=0]
RETAIN _temp36
SCOPE_REGISTER _temp36, __eq_1
_temp37 = CALL (org.ek9.lang::Boolean)_temp36._true() [pure=false, complexity=0]
BRANCH_FALSE _temp37, _return_unset_2
_temp38 = CALL (org.ek9.lang::Boolean)_temp35._true() [pure=false, complexity=0]
RETAIN _temp38
SCOPE_REGISTER _temp38, __eq_1
BRANCH_FALSE _temp38, _return_unset_2
_temp39 = LOAD this.name
RETAIN _temp39
SCOPE_REGISTER _temp39, __eq_1
_temp40 = LOAD param.name
RETAIN _temp40
SCOPE_REGISTER _temp40, __eq_1
_temp41 = CALL (org.ek9.lang::String)_temp39._eq(_temp40) [pure=false, complexity=0]
RETAIN _temp41
SCOPE_REGISTER _temp41, __eq_1
_temp42 = CALL (org.ek9.lang::Boolean)_temp41._isSet() [pure=false, complexity=0]
RETAIN _temp42
SCOPE_REGISTER _temp42, __eq_1
_temp43 = CALL (org.ek9.lang::Boolean)_temp42._true() [pure=false, complexity=0]
BRANCH_FALSE _temp43, _return_unset_2
_temp44 = CALL (org.ek9.lang::Boolean)_temp41._true() [pure=false, complexity=0]
RETAIN _temp44
SCOPE_REGISTER _temp44, __eq_1
BRANCH_FALSE _temp44, _return_false_1
_temp45 = LOAD this.age
RETAIN _temp45
SCOPE_REGISTER _temp45, __eq_1
_temp46 = LOAD param.age
RETAIN _temp46
SCOPE_REGISTER _temp46, __eq_1
_temp47 = CALL (org.ek9.lang::Integer)_temp45._eq(_temp46) [pure=false, complexity=0]
RETAIN _temp47
SCOPE_REGISTER _temp47, __eq_1
_temp48 = CALL (org.ek9.lang::Boolean)_temp47._isSet() [pure=false, complexity=0]
RETAIN _temp48
SCOPE_REGISTER _temp48, __eq_1
_temp49 = CALL (org.ek9.lang::Boolean)_temp48._true() [pure=false, complexity=0]
BRANCH_FALSE _temp49, _return_unset_2
_temp50 = CALL (org.ek9.lang::Boolean)_temp47._true() [pure=false, complexity=0]
RETAIN _temp50
SCOPE_REGISTER _temp50, __eq_1
BRANCH_FALSE _temp50, _return_false_1
BRANCH _return_true_1
LABEL _return_unset_2
_temp51 = CALL (org.ek9.lang::Boolean)org.ek9.lang::Boolean.<init>() [pure=false, complexity=0]
RETAIN _temp51
SCOPE_REGISTER _temp51, __eq_1
STORE rtn, _temp51
RETAIN rtn
SCOPE_EXIT __eq_1
RETURN rtn
LABEL _return_false_1
_temp52 = CALL_STATIC (org.ek9.lang::Boolean)._ofFalse() [pure=false, complexity=0]
RETAIN _temp52
SCOPE_REGISTER _temp52, __eq_1
STORE rtn, _temp52
RETAIN rtn
SCOPE_EXIT __eq_1
RETURN rtn
LABEL _return_true_1
_temp53 = CALL_STATIC (org.ek9.lang::Boolean)._ofTrue() [pure=false, complexity=0]
RETAIN _temp53
SCOPE_REGISTER _temp53, __eq_1
STORE rtn, _temp53
RETAIN rtn
SCOPE_EXIT __eq_1
RETURN rtn
OperationDfn: synthetic.classEquals::Person._cmp(synthetic.classEquals::Person)->org.ek9.lang::Integer  
BasicBlock: _entry_1
SCOPE_ENTER __cmp_1
REFERENCE rtn, org.ek9.lang::Integer
_temp1 = CALL (synthetic.classEquals::Person)this._isSet() [pure=false, complexity=0]
RETAIN _temp1
SCOPE_REGISTER _temp1, __cmp_1
_temp2 = CALL (org.ek9.lang::Boolean)_temp1._true() [pure=false, complexity=0]
BRANCH_FALSE _temp2, _return_unset_1
_temp3 = CALL (synthetic.classEquals::Person)param._isSet() [pure=false, complexity=0]
RETAIN _temp3
SCOPE_REGISTER _temp3, __cmp_1
_temp4 = CALL (org.ek9.lang::Boolean)_temp3._true() [pure=false, complexity=0]
BRANCH_FALSE _temp4, _return_unset_1
_temp5 = CALL (synthetic.classEquals::Person)this._fieldSetStatus() [pure=false, complexity=0]
RETAIN _temp5
SCOPE_REGISTER _temp5, __cmp_1
_temp6 = CALL (synthetic.classEquals::Person)param._fieldSetStatus() [pure=false, complexity=0]
RETAIN _temp6
SCOPE_REGISTER _temp6, __cmp_1
_temp7 = CALL (org.ek9.lang::Bits)_temp5._eq(_temp6) [pure=false, complexity=0]
RETAIN _temp7
SCOPE_REGISTER _temp7, __cmp_1
_temp8 = CALL (org.ek9.lang::Boolean)_temp7._isSet() [pure=false, complexity=0]
RETAIN _temp8
SCOPE_REGISTER _temp8, __cmp_1
_temp9 = CALL (org.ek9.lang::Boolean)_temp8._true() [pure=false, complexity=0]
BRANCH_FALSE _temp9, _return_unset_1
_temp10 = CALL (org.ek9.lang::Boolean)_temp7._true() [pure=false, complexity=0]
RETAIN _temp10
SCOPE_REGISTER _temp10, __cmp_1
BRANCH_FALSE _temp10, _return_unset_1
_temp11 = LOAD this.name
RETAIN _temp11
SCOPE_REGISTER _temp11, __cmp_1
_temp12 = LOAD param.name
RETAIN _temp12
SCOPE_REGISTER _temp12, __cmp_1
_temp13 = CALL (org.ek9.lang::String)_temp11._cmp(_temp12) [pure=false, complexity=0]
RETAIN _temp13
SCOPE_REGISTER _temp13, __cmp_1
_temp14 = CALL (org.ek9.lang::Integer)_temp13._isSet() [pure=false, complexity=0]
RETAIN _temp14
SCOPE_REGISTER _temp14, __cmp_1
_temp15 = CALL (org.ek9.lang::Boolean)_temp14._true() [pure=false, complexity=0]
BRANCH_FALSE _temp15, _return_unset_1
_temp16 = LOAD_LITERAL 0, org.ek9.lang::Integer
RETAIN _temp16
SCOPE_REGISTER _temp16, __cmp_1
_temp17 = CALL (org.ek9.lang::Integer)_temp13._eq(_temp16) [pure=false, complexity=0]
RETAIN _temp17
SCOPE_REGISTER _temp17, __cmp_1
_temp18 = CALL (org.ek9.lang::Boolean)_temp17._true() [pure=false, complexity=0]
RETAIN _temp18
SCOPE_REGISTER _temp18, __cmp_1
BRANCH_TRUE _temp18, _continue_cmp_1
STORE rtn, _temp13
RETAIN rtn
BRANCH _return_result_1
LABEL _continue_cmp_1
_temp19 = LOAD this.age
RETAIN _temp19
SCOPE_REGISTER _temp19, __cmp_1
_temp20 = LOAD param.age
RETAIN _temp20
SCOPE_REGISTER _temp20, __cmp_1
_temp21 = CALL (org.ek9.lang::Integer)_temp19._cmp(_temp20) [pure=false, complexity=0]
RETAIN _temp21
SCOPE_REGISTER _temp21, __cmp_1
_temp22 = CALL (org.ek9.lang::Integer)_temp21._isSet() [pure=false, complexity=0]
RETAIN _temp22
SCOPE_REGISTER _temp22, __cmp_1
_temp23 = CALL (org.ek9.lang::Boolean)_temp22._true() [pure=false, complexity=0]
BRANCH_FALSE _temp23, _return_unset_1
_temp24 = LOAD_LITERAL 0, org.ek9.lang::Integer
RETAIN _temp24
SCOPE_REGISTER _temp24, __cmp_1
_temp25 = CALL (org.ek9.lang::Integer)_temp21._eq(_temp24) [pure=false, complexity=0]
RETAIN _temp25
SCOPE_REGISTER _temp25, __cmp_1
_temp26 = CALL (org.ek9.lang::Boolean)_temp25._true() [pure=false, complexity=0]
RETAIN _temp26
SCOPE_REGISTER _temp26, __cmp_1
BRANCH_TRUE _temp26, _continue_cmp_2
STORE rtn, _temp21
RETAIN rtn
BRANCH _return_result_1
LABEL _continue_cmp_2
BRANCH _return_zero_1
LABEL _return_unset_1
_temp27 = CALL (org.ek9.lang::Integer)org.ek9.lang::Integer.<init>() [pure=false, complexity=0]
RETAIN _temp27
SCOPE_REGISTER _temp27, __cmp_1
STORE rtn, _temp27
RETAIN rtn
SCOPE_EXIT __cmp_1
RETURN rtn
LABEL _return_zero_1
_temp28 = LOAD_LITERAL 0, org.ek9.lang::Integer
RETAIN _temp28
SCOPE_REGISTER _temp28, __cmp_1
STORE rtn, _temp28
RETAIN rtn
SCOPE_EXIT __cmp_1
RETURN rtn
LABEL _return_result_1
SCOPE_EXIT __cmp_1
RETURN rtn
OperationDfn: synthetic.classEquals::Person.Person()->synthetic.classEquals::Person  
BasicBlock: _entry_3
CALL (synthetic.classEquals::Person)this.i_init() [pure=false, complexity=0]
RETURN this
OperationDfn: synthetic.classEquals::Person.c_init()->org.ek9.lang::Void  
BasicBlock: _entry_1
RETURN
OperationDfn: synthetic.classEquals::Person.i_init()->org.ek9.lang::Void  
BasicBlock: _entry_1
REFERENCE this.name, org.ek9.lang::String
_temp1 = LOAD_LITERAL Steve, org.ek9.lang::String
RETAIN _temp1
SCOPE_REGISTER _temp1, i_init
STORE this.name, _temp1
RETAIN this.name
REFERENCE this.age, org.ek9.lang::Integer
_temp2 = LOAD_LITERAL 25, org.ek9.lang::Integer
RETAIN _temp2
SCOPE_REGISTER _temp2, i_init
STORE this.age, _temp2
RETAIN this.age
RETURN`
    Person
      name <- "Steve"
      age <- 25

      default operator <=>
      default operator ==

//EOF
