#!ek9
<?-
  Test synthetic generation of _hashcode (#?) operator for a class.

  This test verifies:
  1. The SyntheticOperatorGenerator is invoked for default #? operator
  2. The generated IR correctly:
     - Initializes result with _fieldSetStatus() as base hash
     - For each SET field, calls field.#?() and combines with polynomial hash
     - UNSET fields are skipped (their status encoded in base hash)
     - Returns Integer (always set)
-?>
defines module synthetic.classHashCode

  defines class

    @IR: IR_GENERATION: TYPE: "synthetic.classHashCode::Item": `ConstructDfn: synthetic.classHashCode::Item
Field: name, org.ek9.lang::String  
Field: value, org.ek9.lang::Integer  
OperationDfn: synthetic.classHashCode::Item._isSet()->org.ek9.lang::Boolean  
BasicBlock: _entry_1
SCOPE_ENTER __isSet_1
REFERENCE rtn, org.ek9.lang::Boolean
_temp1 = LOAD this.name
RETAIN _temp1
SCOPE_REGISTER _temp1, __isSet_1
_temp2 = CALL (org.ek9.lang::String)_temp1._isSet() [pure=false, complexity=0]
RETAIN _temp2
SCOPE_REGISTER _temp2, __isSet_1
_temp3 = CALL (org.ek9.lang::Boolean)_temp2._true() [pure=false, complexity=0]
RETAIN _temp3
SCOPE_REGISTER _temp3, __isSet_1
BRANCH_FALSE _temp3, _return_false_1
_temp4 = LOAD this.value
RETAIN _temp4
SCOPE_REGISTER _temp4, __isSet_1
_temp5 = CALL (org.ek9.lang::Integer)_temp4._isSet() [pure=false, complexity=0]
RETAIN _temp5
SCOPE_REGISTER _temp5, __isSet_1
_temp6 = CALL (org.ek9.lang::Boolean)_temp5._true() [pure=false, complexity=0]
RETAIN _temp6
SCOPE_REGISTER _temp6, __isSet_1
BRANCH_FALSE _temp6, _return_false_1
BRANCH _return_true_1
LABEL _return_false_1
_temp7 = CALL_STATIC (org.ek9.lang::Boolean)._ofFalse() [pure=false, complexity=0]
RETAIN _temp7
SCOPE_REGISTER _temp7, __isSet_1
STORE rtn, _temp7
RETAIN rtn
SCOPE_EXIT __isSet_1
RETURN rtn
LABEL _return_true_1
_temp8 = CALL_STATIC (org.ek9.lang::Boolean)._ofTrue() [pure=false, complexity=0]
RETAIN _temp8
SCOPE_REGISTER _temp8, __isSet_1
STORE rtn, _temp8
RETAIN rtn
SCOPE_EXIT __isSet_1
RETURN rtn
OperationDfn: synthetic.classHashCode::Item._fieldSetStatus()->org.ek9.lang::Bits  
BasicBlock: _entry_4
SCOPE_ENTER __fieldSetStatus_1
REFERENCE rtn, org.ek9.lang::Bits
_temp25 = LOAD_LITERAL org.ek9.lang::String
RETAIN _temp25
SCOPE_REGISTER _temp25, __fieldSetStatus_1
_temp26 = CALL (org.ek9.lang::Bits)org.ek9.lang::Bits.<init>(_temp25) [pure=false, complexity=0]
RETAIN _temp26
SCOPE_REGISTER _temp26, __fieldSetStatus_1
STORE rtn, _temp26
RETAIN rtn
_temp27 = LOAD this.name
RETAIN _temp27
SCOPE_REGISTER _temp27, __fieldSetStatus_1
_temp28 = CALL (org.ek9.lang::String)_temp27._isSet() [pure=false, complexity=0]
RETAIN _temp28
SCOPE_REGISTER _temp28, __fieldSetStatus_1
CALL (org.ek9.lang::Bits)rtn._addAss(_temp28) [pure=false, complexity=0]
_temp29 = LOAD this.value
RETAIN _temp29
SCOPE_REGISTER _temp29, __fieldSetStatus_1
_temp30 = CALL (org.ek9.lang::Integer)_temp29._isSet() [pure=false, complexity=0]
RETAIN _temp30
SCOPE_REGISTER _temp30, __fieldSetStatus_1
CALL (org.ek9.lang::Bits)rtn._addAss(_temp30) [pure=false, complexity=0]
SCOPE_EXIT __fieldSetStatus_1
RETURN rtn
OperationDfn: synthetic.classHashCode::Item._hashcode()->org.ek9.lang::Integer  
BasicBlock: _entry_2
SCOPE_ENTER __hashcode_1
REFERENCE rtn, org.ek9.lang::Integer
_temp9 = CALL (synthetic.classHashCode::Item)this._fieldSetStatus() [pure=false, complexity=0]
RETAIN _temp9
SCOPE_REGISTER _temp9, __hashcode_1
_temp10 = CALL (org.ek9.lang::Bits)_temp9._hashcode() [pure=false, complexity=0]
RETAIN _temp10
SCOPE_REGISTER _temp10, __hashcode_1
STORE rtn, _temp10
RETAIN rtn
_temp11 = LOAD this.name
RETAIN _temp11
SCOPE_REGISTER _temp11, __hashcode_1
_temp12 = CALL (org.ek9.lang::String)_temp11._isSet() [pure=false, complexity=0]
RETAIN _temp12
SCOPE_REGISTER _temp12, __hashcode_1
_temp13 = CALL (org.ek9.lang::Boolean)_temp12._true() [pure=false, complexity=0]
RETAIN _temp13
SCOPE_REGISTER _temp13, __hashcode_1
BRANCH_FALSE _temp13, _hash_skip_1
_temp14 = CALL (org.ek9.lang::String)_temp11._hashcode() [pure=false, complexity=0]
RETAIN _temp14
SCOPE_REGISTER _temp14, __hashcode_1
_temp15 = LOAD_LITERAL 31, org.ek9.lang::Integer
RETAIN _temp15
SCOPE_REGISTER _temp15, __hashcode_1
_temp16 = CALL (org.ek9.lang::Integer)rtn._mul(_temp15) [pure=false, complexity=0]
RETAIN _temp16
SCOPE_REGISTER _temp16, __hashcode_1
_temp17 = CALL (org.ek9.lang::Integer)_temp16._add(_temp14) [pure=false, complexity=0]
RETAIN _temp17
SCOPE_REGISTER _temp17, __hashcode_1
RELEASE rtn
STORE rtn, _temp17
RETAIN rtn
LABEL _hash_skip_1
_temp18 = LOAD this.value
RETAIN _temp18
SCOPE_REGISTER _temp18, __hashcode_1
_temp19 = CALL (org.ek9.lang::Integer)_temp18._isSet() [pure=false, complexity=0]
RETAIN _temp19
SCOPE_REGISTER _temp19, __hashcode_1
_temp20 = CALL (org.ek9.lang::Boolean)_temp19._true() [pure=false, complexity=0]
RETAIN _temp20
SCOPE_REGISTER _temp20, __hashcode_1
BRANCH_FALSE _temp20, _hash_skip_2
_temp21 = CALL (org.ek9.lang::Integer)_temp18._hashcode() [pure=false, complexity=0]
RETAIN _temp21
SCOPE_REGISTER _temp21, __hashcode_1
_temp22 = LOAD_LITERAL 31, org.ek9.lang::Integer
RETAIN _temp22
SCOPE_REGISTER _temp22, __hashcode_1
_temp23 = CALL (org.ek9.lang::Integer)rtn._mul(_temp22) [pure=false, complexity=0]
RETAIN _temp23
SCOPE_REGISTER _temp23, __hashcode_1
_temp24 = CALL (org.ek9.lang::Integer)_temp23._add(_temp21) [pure=false, complexity=0]
RETAIN _temp24
SCOPE_REGISTER _temp24, __hashcode_1
RELEASE rtn
STORE rtn, _temp24
RETAIN rtn
LABEL _hash_skip_2
SCOPE_EXIT __hashcode_1
RETURN rtn
OperationDfn: synthetic.classHashCode::Item.Item()->synthetic.classHashCode::Item  
BasicBlock: _entry_3
CALL (synthetic.classHashCode::Item)this.i_init() [pure=false, complexity=0]
RETURN this
OperationDfn: synthetic.classHashCode::Item.c_init()->org.ek9.lang::Void  
BasicBlock: _entry_1
RETURN
OperationDfn: synthetic.classHashCode::Item.i_init()->org.ek9.lang::Void  
BasicBlock: _entry_1
REFERENCE this.name, org.ek9.lang::String
_temp1 = LOAD_LITERAL Widget, org.ek9.lang::String
RETAIN _temp1
SCOPE_REGISTER _temp1, i_init
STORE this.name, _temp1
RETAIN this.name
REFERENCE this.value, org.ek9.lang::Integer
_temp2 = LOAD_LITERAL 100, org.ek9.lang::Integer
RETAIN _temp2
SCOPE_REGISTER _temp2, i_init
STORE this.value, _temp2
RETAIN this.value
RETURN`
    Item
      name <- "Widget"
      value <- 100

      default operator ?
      default operator #?

//EOF
